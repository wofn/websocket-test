<!DOCTYPE html>
<html>
  <body>
    <h2>WebSocket Test</h2>

    <!-- ì‚¬ìš©ì ì…ë ¥ í•„ë“œ -->
    <input id="msgInput" placeholder="Message" />

    <!-- ë©”ì‹œì§€ ì „ì†¡ ë²„íŠ¼ -->
    <button onclick="send()">Send</button>

    <!-- ë¡œê·¸ ë©”ì‹œì§€ë¥¼ ë³´ì—¬ì¤„ ë¦¬ìŠ¤íŠ¸ -->
    <ul id="log"></ul>

    <script>
      // WebSocket ê°ì²´ ìƒì„±: Renderì— ë°°í¬ëœ WebSocket ì„œë²„ì— ì—°ê²°
      const ws = new WebSocket("wss://websocket-test-o6mq.onrender.com/ws");

      // ì—°ê²° ì„±ê³µ ì‹œ ë¡œê·¸ ì¶œë ¥
      ws.onopen = () => log("âœ… Connected");

      // ì„œë²„ë¡œë¶€í„° ë©”ì‹œì§€ë¥¼ ìˆ˜ì‹ í–ˆì„ ë•Œ ì²˜ë¦¬
      ws.onmessage = (e) => log("ğŸ“© " + e.data);

      // ì˜¤ë¥˜ ë°œìƒ ì‹œ ë¡œê·¸ ì¶œë ¥
      ws.onerror = (e) => log("âŒ Error");

      // ì—°ê²° ì¢…ë£Œ ì‹œ ë¡œê·¸ ì¶œë ¥
      ws.onclose = () => log("ğŸšª Disconnected");

      // ë©”ì‹œì§€ ì „ì†¡ í•¨ìˆ˜ (Send ë²„íŠ¼ í´ë¦­ ì‹œ í˜¸ì¶œ)
      function send() {
        const msg = document.getElementById("msgInput").value; // ì…ë ¥ê°’ ê°€ì ¸ì˜¤ê¸°
        ws.send(msg);                    // WebSocketì„ í†µí•´ ì„œë²„ë¡œ ì „ì†¡
        log("ğŸ“¤ " + msg);                // ì „ì†¡ëœ ë©”ì‹œì§€ ë¡œê·¸ì— í‘œì‹œ
      }

      // ë©”ì‹œì§€ë¥¼ ë¡œê·¸ ë¦¬ìŠ¤íŠ¸ì— ì¶”ê°€í•˜ëŠ” í•¨ìˆ˜
      function log(msg) {
        const li = document.createElement("li");
        li.textContent = msg;
        document.getElementById("log").appendChild(li);
      }
    </script>
  </body>
</html>
